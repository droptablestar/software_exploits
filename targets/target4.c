#include <stdio.h>
#include <string.h>
#include <stdlib.h> 
#include <unistd.h>
#include <time.h>
#include <ctype.h>

extern unsigned int ebp;
unsigned int ebp;
void check(char * arg)
{
	char passwd[64];
	int con_upp = 0;
	int con_low = 0;
	int con_num = 0;
	int len, i;

//	printf("*arg[1](check): %p ", arg);
//	printf("%p\n", passwd);
	strcpy(passwd, arg);
	len = strlen(passwd);
	for (i = 0; i < len; ++i) {
		con_upp |= isupper(passwd[i]);
		con_low |= islower(passwd[i]);
		con_num |= isdigit(passwd[i]);
	}

	if (len < 16 || con_upp * con_low * con_num == 0)
		printf("Weak passwd.\n");
	else
		printf("Strong passwd.\n");
}

int main(int argc, char ** argv)
{
//	asm("movl %ebp,ebp");
//	printf("ebp: 0x%x ", ebp);
//	printf("ra: %p ", (&check) + 1);
//	printf("*arg[1](main): %p ", argv[1]);
	if (argc < 2) {
		printf("usage: %s password\n", argv[0]);
		return 0;
	}

	check(argv[1]);

	return 0;
}

